window.InitUserScripts = function()
{
var player = GetPlayer();
var object = player.object;
var once = player.once;
var addToTimeline = player.addToTimeline;
var setVar = player.SetVar;
var getVar = player.GetVar;
var update = player.update;
var pointerX = player.pointerX;
var pointerY = player.pointerY;
var showPointer = player.showPointer;
var hidePointer = player.hidePointer;
var slideWidth = player.slideWidth;
var slideHeight = player.slideHeight;
window.Script63 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script64 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script65 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script66 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script67 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script68 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script69 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script70 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script71 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script72 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script73 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script74 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script75 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script76 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script77 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script78 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script79 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script80 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script81 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script82 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script83 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script84 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script85 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script86 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script87 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script88 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script89 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script90 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script91 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script92 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script93 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script94 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script95 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script96 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script97 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script98 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script99 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script100 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script101 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script102 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script103 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script104 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script105 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script106 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script107 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script108 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script109 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script110 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script111 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script112 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script113 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script114 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script115 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script116 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script117 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script118 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script119 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script120 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script121 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script122 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script123 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script124 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script125 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script126 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script127 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script128 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script129 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script130 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script131 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script132 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script133 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script134 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script135 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script136 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script137 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script138 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script139 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script140 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script141 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script142 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script143 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script144 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script145 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script146 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script147 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script148 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script149 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script150 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script151 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script152 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script153 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script154 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script155 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script156 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script157 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script158 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script159 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script160 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script161 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script162 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script163 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script164 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script165 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script166 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script167 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script168 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script169 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script170 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script171 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script172 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script173 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script174 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script175 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script176 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script177 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script178 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script179 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script180 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script181 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script182 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script183 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script184 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script185 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script186 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script187 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script188 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script189 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script190 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script191 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script192 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script193 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script194 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script195 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script196 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script197 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script198 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script199 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script200 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script201 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script202 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script203 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script204 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script205 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script206 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script207 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script208 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script209 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script210 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script211 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script212 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script213 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script214 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script215 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script216 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script217 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script218 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script219 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script220 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script221 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script222 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script223 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script224 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script225 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script226 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script227 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script228 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script229 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script230 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script231 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script232 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script233 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script234 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script235 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script236 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script237 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script238 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script239 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script240 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script241 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script242 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script243 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script244 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script245 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script246 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script247 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script248 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script249 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script250 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script251 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script252 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script253 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script254 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script255 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script256 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script257 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script258 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script259 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script260 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script261 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script262 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script263 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script264 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script265 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script266 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script267 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script268 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script269 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script270 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script271 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script272 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script273 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script274 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script275 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script276 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script277 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script278 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script279 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script280 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script281 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script282 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script283 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script284 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script285 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script286 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script287 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script288 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script289 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script290 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script291 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script292 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script293 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script294 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script295 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script296 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script297 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script298 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script299 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script300 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script301 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script302 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script303 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script304 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script305 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script306 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script307 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script308 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script309 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script310 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script311 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script312 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script313 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script314 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script315 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script316 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script317 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script318 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script319 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script320 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script321 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script322 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script323 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script324 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script325 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script326 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script327 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script328 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script329 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script330 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script331 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script332 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script333 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script334 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script335 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script336 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script337 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script338 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script339 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script340 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script341 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script342 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script343 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script344 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script345 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script346 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script347 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script348 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script349 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script350 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script351 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script352 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script353 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script354 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script355 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script356 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script357 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script358 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script359 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script360 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script361 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script362 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script363 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script364 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script365 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script366 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script367 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script368 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script369 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script370 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script371 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script372 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script373 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script374 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script375 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script376 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script377 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script378 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script379 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script380 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script381 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script382 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script383 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script384 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script385 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script386 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script387 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script388 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script389 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script390 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script391 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script392 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script393 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script394 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script395 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script396 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script397 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script398 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script399 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script400 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script401 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script402 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script403 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script404 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script405 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script406 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script407 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script408 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script409 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script410 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script411 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script412 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script413 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script414 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script415 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script416 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script417 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script418 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script419 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script420 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script421 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script422 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script423 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script424 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script425 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script426 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script427 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script428 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script429 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script430 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script431 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script432 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script433 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script434 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script435 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script436 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script437 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script438 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script439 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script440 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script441 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script442 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script443 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script444 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script445 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script446 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script447 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script448 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script449 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script450 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script451 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script452 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script453 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script454 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script455 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script456 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script457 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script458 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script459 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script460 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script461 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script462 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script463 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script464 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script465 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script466 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script467 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script468 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script469 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script470 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script471 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script472 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script473 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script474 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script475 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script476 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script477 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script478 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script479 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script480 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script481 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script482 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script483 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script484 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script485 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script486 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script487 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script488 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script489 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script490 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script491 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script492 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script493 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script494 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script495 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script496 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script497 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script498 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script499 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script500 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script501 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script502 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script503 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script504 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script505 = function()
{
  // ===== JS for final question =====
var player = GetPlayer();

// Ù…ØªØºÙŠØ±Ø§Øª Storyline
var qIndex = Number(player.GetVar("CurrentQuestionIndex"));
var isCorrect = player.GetVar("IsCorrectAnswer");
var score = Number(player.GetVar("UserScore") || 0);

// Ù†Ø­ÙˆÙ„ isCorrect Ù„Ù‚ÙŠÙ…Ø© Ù…Ù†Ø·Ù‚ÙŠØ© Ø­Ù‚ÙŠÙ‚ÙŠØ©
var isCorrectBool = (isCorrect === true || isCorrect === "True");

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù„ØªØªØ¨Ø¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {};
}

// Ù„Ùˆ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù„Ø³Ù‡ Ù…Ø§ Ø§ØªØ­Ø³Ø¨Ø´ Ù‚Ø¨Ù„ ÙƒØ¯Ù‡
if (!window.scoredQuestions[qIndex]) {
    if (isCorrectBool) {
        score += 1;
        player.SetVar("UserScore", score);
    }
    window.scoredQuestions[qIndex] = { prevState: isCorrectBool };
} else {
    // Ù„Ùˆ Ø§ØªØ­Ø³Ø¨ Ù‚Ø¨Ù„ ÙƒØ¯Ù‡ØŒ Ù†Ø´ÙˆÙ Ø¥Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØªØºÙŠÙ‘Ø±Øª
    var prevState = window.scoredQuestions[qIndex].prevState;
    if (prevState !== isCorrectBool) {
        if (isCorrectBool) {
            score += 1;
        } else if (score > 0) {
            score -= 1;
        }
        player.SetVar("UserScore", score);
        window.scoredQuestions[qIndex].prevState = isCorrectBool;
    }
}

// ===== Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© =====
var totalQuestions = 20; // âœ… Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ÙƒÙ„ÙŠ
var percent = Math.round((score / totalQuestions) * 100);
player.SetVar("ScorePercent", percent);

// ===== DEBUG Console Output =====
console.clear();
console.log("=======================================");
console.log("ğŸ”¢ Current Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrectBool);
console.log("ğŸ† UserScore (final):", score);
console.log("ğŸ“Š ScorePercent:", percent + "%");
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

// ===== Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙÙŠØ¯Ø¨Ø§Ùƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø¢Ø®Ø± Ø³Ø¤Ø§Ù„) =====
if (qIndex === totalQuestions) {
    if (percent >= 60) {
        player.SetVar("FinalFeedback", "Ø±Ø§Ø¦Ø¹! Ù„Ù‚Ø¯ Ø§Ø¬ØªØ²Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­ ğŸ‘");
    } else {
        player.SetVar("FinalFeedback", "Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ğŸ˜… Ø§Ù„Ù†Ø³Ø¨Ø© Ø£Ù‚Ù„ Ù…Ù† 60%");
    }
}

}

window.Script506 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script507 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script508 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script509 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script510 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script511 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script512 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script513 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script514 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script515 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script516 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script517 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script518 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script519 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script520 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script521 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script522 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script523 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script524 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script525 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script526 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script527 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script528 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script529 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script530 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script531 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script532 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script533 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script534 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script535 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script536 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script537 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script538 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script539 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script540 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script541 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script542 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script543 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script544 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script545 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script546 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script547 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script548 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script549 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script550 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script551 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script552 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script553 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script554 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script555 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script556 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script557 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script558 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script559 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script560 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script561 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script562 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script563 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script564 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script565 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script566 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script567 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script568 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script569 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script570 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script571 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script572 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script573 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script574 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script575 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script576 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script577 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script578 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script579 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script580 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script581 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script582 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script583 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script584 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script585 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script586 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script587 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script588 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script589 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script590 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script591 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script592 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script593 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script594 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script595 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script596 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script597 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script598 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script599 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script600 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script601 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script602 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script603 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script604 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script605 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script606 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script607 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script608 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script609 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script610 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script611 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script612 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script613 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script614 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script615 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script616 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script617 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script618 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script619 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script620 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script621 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script622 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script623 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script624 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script625 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script626 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script627 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script628 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script629 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script630 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script631 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script632 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script633 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script634 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script635 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script636 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script637 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script638 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script639 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script640 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script641 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script642 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script643 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script644 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script645 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script646 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script647 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script648 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script649 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script650 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script651 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script652 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script653 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script654 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script655 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script656 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script657 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script658 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script659 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script660 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script661 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script662 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script663 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script664 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script665 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script666 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script667 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script668 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script669 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script670 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script671 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script672 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script673 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script674 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script675 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script676 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script677 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script678 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script679 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script680 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script681 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script682 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script683 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script684 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script685 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script686 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script687 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script688 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script689 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script690 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script691 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script692 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script693 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script694 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script695 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script696 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script697 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script698 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script699 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script700 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script701 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script702 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script703 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script704 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script705 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script706 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script707 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script708 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script709 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script710 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script711 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script712 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script713 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script714 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script715 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script716 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script717 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script718 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script719 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script720 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script721 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script722 = function()
{
  var player = GetPlayer();

// Ø£Ø³Ù…Ø§Ø¡ ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
var dragModelIds = [
  '6m3mtrTTH62',  // drag1
  '6oMgLhZBMW3',  // drag2
  '5dLiYnBFAgX',  // drag3
  '5iPLgCeg55a',  // drag4
  '5iVB0a6u6OV',  // drag5
//   '5ixjuqmt25w',  // drag6
//   '5unDLHRojVI',  // drag7
//   '5gvUEWXZBMu',  // drag8
//   '6Kjrk3lhudc',  // drag9


];


// Ù…Ø¹Ø±ÙØ§Øª Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø¥ÙÙ„Ø§Øª
var dropModelIds = [
  '6N0EPn0CpVu',  // drop1
  '6iPIvTxgoNO',  // drop2
  '6gbaC8cxKRT',  // drop3
  '5hxHyeInM3A',  // drop4
  '6n6r7v9VXFk',  // drop5
//   '6Q3C13oYPCE',  // drop6
//   '6ExgiddKKEV',  // drop7
//   '6ixGXjk4Ii3',  // drop8
//   '5zTQ4tqsOdI',  // drop9

  


];

// Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙØ¹Ø¯ Ø§Ù„Ù…ÙƒØ§Ù†ÙŠ Ù„Ù„Ø¹Ù†Ø§ØµØ±
function getRect(id) {
  var el = document.querySelector("[data-model-id='" + id + "']");
  if (!el) {
    console.warn(`Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù€ DOM: ${id}`);
    return null;
  }
  return el.getBoundingClientRect();
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„Ø¡ ÙƒÙ„ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø¨Ø¥Ø¬Ø§Ø¨Ø§Øª
function checkDropsFilledAccurately() {
  console.log('Ø¨Ø¯Ø¡ ÙØ­Øµ checkDropsFilledAccurately');

  // Ø¬Ù…Ø¹ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨
  var dragsRects = dragModelIds.map((id, index) => ({ id, rect: getRect(id) })).filter(item => item.rect);
  console.log(`Ø¹Ø¯Ø¯ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©: ${dragsRects.length} Ù…Ù† ${dragModelIds.length}`);
  dragsRects.forEach(item => {
    console.log(`Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø­Ø¨ ${item.id}: left=${item.rect.left}, right=${item.rect.right}, top=${item.rect.top}, bottom=${item.rect.bottom}`);
  });

  if (dragsRects.length !== dragModelIds.length) {
    console.warn("Ø¨Ø¹Ø¶ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù€ DOM");
    player.SetVar("allDropsExactlyFilled", false);
    console.log(`allDropsExactlyFilled: false (Ø¨Ø³Ø¨Ø¨ Ù†Ù‚Øµ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨)`);
    return;
  }

  var filledCount = 0;
  var usedDragIds = []; // ØªØªØ¨Ø¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

  dropModelIds.forEach(function(dropId) {
    var dropRect = getRect(dropId);
    if (!dropRect) {
      console.warn(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${dropId}`);
      return;
    }
    console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId}: left=${dropRect.left}, right=${dropRect.right}, top=${dropRect.top}, bottom=${dropRect.bottom}`);

    var hasDrag = dragsRects.some(function(dragItem) {
      var dragRect = dragItem.rect;
      var dragId = dragItem.id;

      if (usedDragIds.includes(dragId)) {
        console.log(`Ø§Ù„Ø¹Ù†ØµØ± ${dragId} Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„`);
        return false;
      }

      var cx = (dragRect.left + dragRect.right) / 2;
      var cy = (dragRect.top + dragRect.bottom) / 2;
      console.log(`Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø­Ø¨ ${dragId}: Ù…Ø±ÙƒØ² (x=${cx}, y=${cy})`);

      var isInside = (
        cx >= dropRect.left &&
        cx <= dropRect.right &&
        cy >= dropRect.top &&
        cy <= dropRect.bottom
      );

      console.log(`Ù‡Ù„ Ø§Ù„Ø¹Ù†ØµØ± ${dragId} Ø¯Ø§Ø®Ù„ ${dropId}ØŸ ${isInside}`);

      if (isInside) {
        usedDragIds.push(dragId);
        console.log(`Ø§Ù„Ø¹Ù†ØµØ± ${dragId} ØªÙ… Ø¥ÙÙ„Ø§ØªÙ‡ ÙÙŠ ${dropId}`);
        return true;
      }
      return false;
    });

    if (hasDrag) {
      filledCount++;
      console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId} Ù…Ù…Ù„ÙˆØ¡`);
    } else {
      console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId} ØºÙŠØ± Ù…Ù…Ù„ÙˆØ¡`);
    }
  });

  console.log(`Ø¹Ø¯Ø¯ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø§Ù„Ù…Ù…Ù„ÙˆØ¡Ø©: ${filledCount} Ù…Ù† ${dropModelIds.length}`);
  console.log(`Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${usedDragIds.join(', ') || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³ØªØ®Ø¯Ù…Ø©'}`);

  var allFilled = (filledCount === dropModelIds.length);
  player.SetVar("allDropsExactlyFilled", allFilled);
  console.log(`allDropsExactlyFilled: ${allFilled}`);
}

// Ø±Ø¨Ø· Ø§Ù„Ø­Ø¯Ø« Ø¨ÙƒÙ„ Ø¹Ù†ØµØ± Ø³Ø­Ø¨
dragModelIds.forEach(function(dId) {
  var el = document.querySelector("[data-model-id='" + dId + "']");
  if (!el) {
    console.warn(`Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${dId}`);
    return;
  }

  el.addEventListener("mouseup", function () {
    console.log(`Ø­Ø¯Ø« mouseup Ù„Ù„Ø¹Ù†ØµØ±: ${dId}`);
    setTimeout(checkDropsFilledAccurately, 100);
  });
});

// ÙØ­Øµ Ø£ÙˆÙ„ÙŠ Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ø¨Ø³ÙŠØ·
setTimeout(checkDropsFilledAccurately, 200);




}

window.Script723 = function()
{
  var player = GetPlayer();

// Ø£Ø³Ù…Ø§Ø¡ ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
var dragModelIds = [
  '6m3mtrTTH62',  // drag1
  '6oMgLhZBMW3',  // drag2
  '5dLiYnBFAgX',  // drag3
  '5iPLgCeg55a',  // drag4
  '5iVB0a6u6OV',  // drag5
//   '5ixjuqmt25w',  // drag6
//   '5unDLHRojVI',  // drag7
//   '5gvUEWXZBMu',  // drag8
//   '6Kjrk3lhudc',  // drag9


];


// Ù…Ø¹Ø±ÙØ§Øª Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø¥ÙÙ„Ø§Øª
var dropModelIds = [
  '6N0EPn0CpVu',  // drop1
  '6iPIvTxgoNO',  // drop2
  '6gbaC8cxKRT',  // drop3
  '5hxHyeInM3A',  // drop4
  '6n6r7v9VXFk',  // drop5
//   '6Q3C13oYPCE',  // drop6
//   '6ExgiddKKEV',  // drop7
//   '6ixGXjk4Ii3',  // drop8
//   '5zTQ4tqsOdI',  // drop9

  


];

// Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙØ¹Ø¯ Ø§Ù„Ù…ÙƒØ§Ù†ÙŠ Ù„Ù„Ø¹Ù†Ø§ØµØ±
function getRect(id) {
  var el = document.querySelector("[data-model-id='" + id + "']");
  if (!el) {
    console.warn(`Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù€ DOM: ${id}`);
    return null;
  }
  return el.getBoundingClientRect();
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„Ø¡ ÙƒÙ„ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø¨Ø¥Ø¬Ø§Ø¨Ø§Øª
function checkDropsFilledAccurately() {
  console.log('Ø¨Ø¯Ø¡ ÙØ­Øµ checkDropsFilledAccurately');

  // Ø¬Ù…Ø¹ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨
  var dragsRects = dragModelIds.map((id, index) => ({ id, rect: getRect(id) })).filter(item => item.rect);
  console.log(`Ø¹Ø¯Ø¯ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©: ${dragsRects.length} Ù…Ù† ${dragModelIds.length}`);
  dragsRects.forEach(item => {
    console.log(`Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø­Ø¨ ${item.id}: left=${item.rect.left}, right=${item.rect.right}, top=${item.rect.top}, bottom=${item.rect.bottom}`);
  });

  if (dragsRects.length !== dragModelIds.length) {
    console.warn("Ø¨Ø¹Ø¶ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù€ DOM");
    player.SetVar("allDropsExactlyFilled", false);
    console.log(`allDropsExactlyFilled: false (Ø¨Ø³Ø¨Ø¨ Ù†Ù‚Øµ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨)`);
    return;
  }

  var filledCount = 0;
  var usedDragIds = []; // ØªØªØ¨Ø¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

  dropModelIds.forEach(function(dropId) {
    var dropRect = getRect(dropId);
    if (!dropRect) {
      console.warn(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${dropId}`);
      return;
    }
    console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId}: left=${dropRect.left}, right=${dropRect.right}, top=${dropRect.top}, bottom=${dropRect.bottom}`);

    var hasDrag = dragsRects.some(function(dragItem) {
      var dragRect = dragItem.rect;
      var dragId = dragItem.id;

      if (usedDragIds.includes(dragId)) {
        console.log(`Ø§Ù„Ø¹Ù†ØµØ± ${dragId} Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„`);
        return false;
      }

      var cx = (dragRect.left + dragRect.right) / 2;
      var cy = (dragRect.top + dragRect.bottom) / 2;
      console.log(`Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø­Ø¨ ${dragId}: Ù…Ø±ÙƒØ² (x=${cx}, y=${cy})`);

      var isInside = (
        cx >= dropRect.left &&
        cx <= dropRect.right &&
        cy >= dropRect.top &&
        cy <= dropRect.bottom
      );

      console.log(`Ù‡Ù„ Ø§Ù„Ø¹Ù†ØµØ± ${dragId} Ø¯Ø§Ø®Ù„ ${dropId}ØŸ ${isInside}`);

      if (isInside) {
        usedDragIds.push(dragId);
        console.log(`Ø§Ù„Ø¹Ù†ØµØ± ${dragId} ØªÙ… Ø¥ÙÙ„Ø§ØªÙ‡ ÙÙŠ ${dropId}`);
        return true;
      }
      return false;
    });

    if (hasDrag) {
      filledCount++;
      console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId} Ù…Ù…Ù„ÙˆØ¡`);
    } else {
      console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId} ØºÙŠØ± Ù…Ù…Ù„ÙˆØ¡`);
    }
  });

  console.log(`Ø¹Ø¯Ø¯ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø§Ù„Ù…Ù…Ù„ÙˆØ¡Ø©: ${filledCount} Ù…Ù† ${dropModelIds.length}`);
  console.log(`Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${usedDragIds.join(', ') || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³ØªØ®Ø¯Ù…Ø©'}`);

  var allFilled = (filledCount === dropModelIds.length);
  player.SetVar("allDropsExactlyFilled", allFilled);
  console.log(`allDropsExactlyFilled: ${allFilled}`);
}

// Ø±Ø¨Ø· Ø§Ù„Ø­Ø¯Ø« Ø¨ÙƒÙ„ Ø¹Ù†ØµØ± Ø³Ø­Ø¨
dragModelIds.forEach(function(dId) {
  var el = document.querySelector("[data-model-id='" + dId + "']");
  if (!el) {
    console.warn(`Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${dId}`);
    return;
  }

  el.addEventListener("mouseup", function () {
    console.log(`Ø­Ø¯Ø« mouseup Ù„Ù„Ø¹Ù†ØµØ±: ${dId}`);
    setTimeout(checkDropsFilledAccurately, 100);
  });
});

// ÙØ­Øµ Ø£ÙˆÙ„ÙŠ Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ø¨Ø³ÙŠØ·
setTimeout(checkDropsFilledAccurately, 200);




}

window.Script724 = function()
{
  var player = GetPlayer();

// Ø£Ø³Ù…Ø§Ø¡ ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
var dragModelIds = [
  '6m3mtrTTH62',  // drag1
  '6oMgLhZBMW3',  // drag2
  '5dLiYnBFAgX',  // drag3
  '5iPLgCeg55a',  // drag4
  '5iVB0a6u6OV',  // drag5
//   '5ixjuqmt25w',  // drag6
//   '5unDLHRojVI',  // drag7
//   '5gvUEWXZBMu',  // drag8
//   '6Kjrk3lhudc',  // drag9


];


// Ù…Ø¹Ø±ÙØ§Øª Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø¥ÙÙ„Ø§Øª
var dropModelIds = [
  '6N0EPn0CpVu',  // drop1
  '6iPIvTxgoNO',  // drop2
  '6gbaC8cxKRT',  // drop3
  '5hxHyeInM3A',  // drop4
  '6n6r7v9VXFk',  // drop5
//   '6Q3C13oYPCE',  // drop6
//   '6ExgiddKKEV',  // drop7
//   '6ixGXjk4Ii3',  // drop8
//   '5zTQ4tqsOdI',  // drop9

  


];

// Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙØ¹Ø¯ Ø§Ù„Ù…ÙƒØ§Ù†ÙŠ Ù„Ù„Ø¹Ù†Ø§ØµØ±
function getRect(id) {
  var el = document.querySelector("[data-model-id='" + id + "']");
  if (!el) {
    console.warn(`Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù€ DOM: ${id}`);
    return null;
  }
  return el.getBoundingClientRect();
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„Ø¡ ÙƒÙ„ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø¨Ø¥Ø¬Ø§Ø¨Ø§Øª
function checkDropsFilledAccurately() {
  console.log('Ø¨Ø¯Ø¡ ÙØ­Øµ checkDropsFilledAccurately');

  // Ø¬Ù…Ø¹ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨
  var dragsRects = dragModelIds.map((id, index) => ({ id, rect: getRect(id) })).filter(item => item.rect);
  console.log(`Ø¹Ø¯Ø¯ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©: ${dragsRects.length} Ù…Ù† ${dragModelIds.length}`);
  dragsRects.forEach(item => {
    console.log(`Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø­Ø¨ ${item.id}: left=${item.rect.left}, right=${item.rect.right}, top=${item.rect.top}, bottom=${item.rect.bottom}`);
  });

  if (dragsRects.length !== dragModelIds.length) {
    console.warn("Ø¨Ø¹Ø¶ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù€ DOM");
    player.SetVar("allDropsExactlyFilled", false);
    console.log(`allDropsExactlyFilled: false (Ø¨Ø³Ø¨Ø¨ Ù†Ù‚Øµ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨)`);
    return;
  }

  var filledCount = 0;
  var usedDragIds = []; // ØªØªØ¨Ø¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

  dropModelIds.forEach(function(dropId) {
    var dropRect = getRect(dropId);
    if (!dropRect) {
      console.warn(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${dropId}`);
      return;
    }
    console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId}: left=${dropRect.left}, right=${dropRect.right}, top=${dropRect.top}, bottom=${dropRect.bottom}`);

    var hasDrag = dragsRects.some(function(dragItem) {
      var dragRect = dragItem.rect;
      var dragId = dragItem.id;

      if (usedDragIds.includes(dragId)) {
        console.log(`Ø§Ù„Ø¹Ù†ØµØ± ${dragId} Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„`);
        return false;
      }

      var cx = (dragRect.left + dragRect.right) / 2;
      var cy = (dragRect.top + dragRect.bottom) / 2;
      console.log(`Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø­Ø¨ ${dragId}: Ù…Ø±ÙƒØ² (x=${cx}, y=${cy})`);

      var isInside = (
        cx >= dropRect.left &&
        cx <= dropRect.right &&
        cy >= dropRect.top &&
        cy <= dropRect.bottom
      );

      console.log(`Ù‡Ù„ Ø§Ù„Ø¹Ù†ØµØ± ${dragId} Ø¯Ø§Ø®Ù„ ${dropId}ØŸ ${isInside}`);

      if (isInside) {
        usedDragIds.push(dragId);
        console.log(`Ø§Ù„Ø¹Ù†ØµØ± ${dragId} ØªÙ… Ø¥ÙÙ„Ø§ØªÙ‡ ÙÙŠ ${dropId}`);
        return true;
      }
      return false;
    });

    if (hasDrag) {
      filledCount++;
      console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId} Ù…Ù…Ù„ÙˆØ¡`);
    } else {
      console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId} ØºÙŠØ± Ù…Ù…Ù„ÙˆØ¡`);
    }
  });

  console.log(`Ø¹Ø¯Ø¯ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø§Ù„Ù…Ù…Ù„ÙˆØ¡Ø©: ${filledCount} Ù…Ù† ${dropModelIds.length}`);
  console.log(`Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${usedDragIds.join(', ') || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³ØªØ®Ø¯Ù…Ø©'}`);

  var allFilled = (filledCount === dropModelIds.length);
  player.SetVar("allDropsExactlyFilled", allFilled);
  console.log(`allDropsExactlyFilled: ${allFilled}`);
}

// Ø±Ø¨Ø· Ø§Ù„Ø­Ø¯Ø« Ø¨ÙƒÙ„ Ø¹Ù†ØµØ± Ø³Ø­Ø¨
dragModelIds.forEach(function(dId) {
  var el = document.querySelector("[data-model-id='" + dId + "']");
  if (!el) {
    console.warn(`Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${dId}`);
    return;
  }

  el.addEventListener("mouseup", function () {
    console.log(`Ø­Ø¯Ø« mouseup Ù„Ù„Ø¹Ù†ØµØ±: ${dId}`);
    setTimeout(checkDropsFilledAccurately, 100);
  });
});

// ÙØ­Øµ Ø£ÙˆÙ„ÙŠ Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ø¨Ø³ÙŠØ·
setTimeout(checkDropsFilledAccurately, 200);




}

window.Script725 = function()
{
  var player = GetPlayer();

// Ø£Ø³Ù…Ø§Ø¡ ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
var dragModelIds = [
  '6m3mtrTTH62',  // drag1
  '6oMgLhZBMW3',  // drag2
  '5dLiYnBFAgX',  // drag3
  '5iPLgCeg55a',  // drag4
  '5iVB0a6u6OV',  // drag5
//   '5ixjuqmt25w',  // drag6
//   '5unDLHRojVI',  // drag7
//   '5gvUEWXZBMu',  // drag8
//   '6Kjrk3lhudc',  // drag9


];


// Ù…Ø¹Ø±ÙØ§Øª Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø¥ÙÙ„Ø§Øª
var dropModelIds = [
  '6N0EPn0CpVu',  // drop1
  '6iPIvTxgoNO',  // drop2
  '6gbaC8cxKRT',  // drop3
  '5hxHyeInM3A',  // drop4
  '6n6r7v9VXFk',  // drop5
//   '6Q3C13oYPCE',  // drop6
//   '6ExgiddKKEV',  // drop7
//   '6ixGXjk4Ii3',  // drop8
//   '5zTQ4tqsOdI',  // drop9

  


];

// Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙØ¹Ø¯ Ø§Ù„Ù…ÙƒØ§Ù†ÙŠ Ù„Ù„Ø¹Ù†Ø§ØµØ±
function getRect(id) {
  var el = document.querySelector("[data-model-id='" + id + "']");
  if (!el) {
    console.warn(`Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù€ DOM: ${id}`);
    return null;
  }
  return el.getBoundingClientRect();
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„Ø¡ ÙƒÙ„ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø¨Ø¥Ø¬Ø§Ø¨Ø§Øª
function checkDropsFilledAccurately() {
  console.log('Ø¨Ø¯Ø¡ ÙØ­Øµ checkDropsFilledAccurately');

  // Ø¬Ù…Ø¹ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨
  var dragsRects = dragModelIds.map((id, index) => ({ id, rect: getRect(id) })).filter(item => item.rect);
  console.log(`Ø¹Ø¯Ø¯ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©: ${dragsRects.length} Ù…Ù† ${dragModelIds.length}`);
  dragsRects.forEach(item => {
    console.log(`Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø­Ø¨ ${item.id}: left=${item.rect.left}, right=${item.rect.right}, top=${item.rect.top}, bottom=${item.rect.bottom}`);
  });

  if (dragsRects.length !== dragModelIds.length) {
    console.warn("Ø¨Ø¹Ø¶ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù€ DOM");
    player.SetVar("allDropsExactlyFilled", false);
    console.log(`allDropsExactlyFilled: false (Ø¨Ø³Ø¨Ø¨ Ù†Ù‚Øµ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨)`);
    return;
  }

  var filledCount = 0;
  var usedDragIds = []; // ØªØªØ¨Ø¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

  dropModelIds.forEach(function(dropId) {
    var dropRect = getRect(dropId);
    if (!dropRect) {
      console.warn(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${dropId}`);
      return;
    }
    console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId}: left=${dropRect.left}, right=${dropRect.right}, top=${dropRect.top}, bottom=${dropRect.bottom}`);

    var hasDrag = dragsRects.some(function(dragItem) {
      var dragRect = dragItem.rect;
      var dragId = dragItem.id;

      if (usedDragIds.includes(dragId)) {
        console.log(`Ø§Ù„Ø¹Ù†ØµØ± ${dragId} Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„`);
        return false;
      }

      var cx = (dragRect.left + dragRect.right) / 2;
      var cy = (dragRect.top + dragRect.bottom) / 2;
      console.log(`Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø­Ø¨ ${dragId}: Ù…Ø±ÙƒØ² (x=${cx}, y=${cy})`);

      var isInside = (
        cx >= dropRect.left &&
        cx <= dropRect.right &&
        cy >= dropRect.top &&
        cy <= dropRect.bottom
      );

      console.log(`Ù‡Ù„ Ø§Ù„Ø¹Ù†ØµØ± ${dragId} Ø¯Ø§Ø®Ù„ ${dropId}ØŸ ${isInside}`);

      if (isInside) {
        usedDragIds.push(dragId);
        console.log(`Ø§Ù„Ø¹Ù†ØµØ± ${dragId} ØªÙ… Ø¥ÙÙ„Ø§ØªÙ‡ ÙÙŠ ${dropId}`);
        return true;
      }
      return false;
    });

    if (hasDrag) {
      filledCount++;
      console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId} Ù…Ù…Ù„ÙˆØ¡`);
    } else {
      console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId} ØºÙŠØ± Ù…Ù…Ù„ÙˆØ¡`);
    }
  });

  console.log(`Ø¹Ø¯Ø¯ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø§Ù„Ù…Ù…Ù„ÙˆØ¡Ø©: ${filledCount} Ù…Ù† ${dropModelIds.length}`);
  console.log(`Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${usedDragIds.join(', ') || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³ØªØ®Ø¯Ù…Ø©'}`);

  var allFilled = (filledCount === dropModelIds.length);
  player.SetVar("allDropsExactlyFilled", allFilled);
  console.log(`allDropsExactlyFilled: ${allFilled}`);
}

// Ø±Ø¨Ø· Ø§Ù„Ø­Ø¯Ø« Ø¨ÙƒÙ„ Ø¹Ù†ØµØ± Ø³Ø­Ø¨
dragModelIds.forEach(function(dId) {
  var el = document.querySelector("[data-model-id='" + dId + "']");
  if (!el) {
    console.warn(`Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${dId}`);
    return;
  }

  el.addEventListener("mouseup", function () {
    console.log(`Ø­Ø¯Ø« mouseup Ù„Ù„Ø¹Ù†ØµØ±: ${dId}`);
    setTimeout(checkDropsFilledAccurately, 100);
  });
});

// ÙØ­Øµ Ø£ÙˆÙ„ÙŠ Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ø¨Ø³ÙŠØ·
setTimeout(checkDropsFilledAccurately, 200);




}

window.Script726 = function()
{
  var player = GetPlayer();

// Ø£Ø³Ù…Ø§Ø¡ ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
var dragModelIds = [
  '6m3mtrTTH62',  // drag1
  '6oMgLhZBMW3',  // drag2
  '5dLiYnBFAgX',  // drag3
  '5iPLgCeg55a',  // drag4
  '5iVB0a6u6OV',  // drag5
//   '5ixjuqmt25w',  // drag6
//   '5unDLHRojVI',  // drag7
//   '5gvUEWXZBMu',  // drag8
//   '6Kjrk3lhudc',  // drag9


];


// Ù…Ø¹Ø±ÙØ§Øª Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø¥ÙÙ„Ø§Øª
var dropModelIds = [
  '6N0EPn0CpVu',  // drop1
  '6iPIvTxgoNO',  // drop2
  '6gbaC8cxKRT',  // drop3
  '5hxHyeInM3A',  // drop4
  '6n6r7v9VXFk',  // drop5
//   '6Q3C13oYPCE',  // drop6
//   '6ExgiddKKEV',  // drop7
//   '6ixGXjk4Ii3',  // drop8
//   '5zTQ4tqsOdI',  // drop9

  


];

// Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙØ¹Ø¯ Ø§Ù„Ù…ÙƒØ§Ù†ÙŠ Ù„Ù„Ø¹Ù†Ø§ØµØ±
function getRect(id) {
  var el = document.querySelector("[data-model-id='" + id + "']");
  if (!el) {
    console.warn(`Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù€ DOM: ${id}`);
    return null;
  }
  return el.getBoundingClientRect();
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„Ø¡ ÙƒÙ„ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø¨Ø¥Ø¬Ø§Ø¨Ø§Øª
function checkDropsFilledAccurately() {
  console.log('Ø¨Ø¯Ø¡ ÙØ­Øµ checkDropsFilledAccurately');

  // Ø¬Ù…Ø¹ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨
  var dragsRects = dragModelIds.map((id, index) => ({ id, rect: getRect(id) })).filter(item => item.rect);
  console.log(`Ø¹Ø¯Ø¯ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©: ${dragsRects.length} Ù…Ù† ${dragModelIds.length}`);
  dragsRects.forEach(item => {
    console.log(`Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø­Ø¨ ${item.id}: left=${item.rect.left}, right=${item.rect.right}, top=${item.rect.top}, bottom=${item.rect.bottom}`);
  });

  if (dragsRects.length !== dragModelIds.length) {
    console.warn("Ø¨Ø¹Ø¶ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù€ DOM");
    player.SetVar("allDropsExactlyFilled", false);
    console.log(`allDropsExactlyFilled: false (Ø¨Ø³Ø¨Ø¨ Ù†Ù‚Øµ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø­Ø¨)`);
    return;
  }

  var filledCount = 0;
  var usedDragIds = []; // ØªØªØ¨Ø¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

  dropModelIds.forEach(function(dropId) {
    var dropRect = getRect(dropId);
    if (!dropRect) {
      console.warn(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${dropId}`);
      return;
    }
    console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId}: left=${dropRect.left}, right=${dropRect.right}, top=${dropRect.top}, bottom=${dropRect.bottom}`);

    var hasDrag = dragsRects.some(function(dragItem) {
      var dragRect = dragItem.rect;
      var dragId = dragItem.id;

      if (usedDragIds.includes(dragId)) {
        console.log(`Ø§Ù„Ø¹Ù†ØµØ± ${dragId} Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„`);
        return false;
      }

      var cx = (dragRect.left + dragRect.right) / 2;
      var cy = (dragRect.top + dragRect.bottom) / 2;
      console.log(`Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø­Ø¨ ${dragId}: Ù…Ø±ÙƒØ² (x=${cx}, y=${cy})`);

      var isInside = (
        cx >= dropRect.left &&
        cx <= dropRect.right &&
        cy >= dropRect.top &&
        cy <= dropRect.bottom
      );

      console.log(`Ù‡Ù„ Ø§Ù„Ø¹Ù†ØµØ± ${dragId} Ø¯Ø§Ø®Ù„ ${dropId}ØŸ ${isInside}`);

      if (isInside) {
        usedDragIds.push(dragId);
        console.log(`Ø§Ù„Ø¹Ù†ØµØ± ${dragId} ØªÙ… Ø¥ÙÙ„Ø§ØªÙ‡ ÙÙŠ ${dropId}`);
        return true;
      }
      return false;
    });

    if (hasDrag) {
      filledCount++;
      console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId} Ù…Ù…Ù„ÙˆØ¡`);
    } else {
      console.log(`Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ÙÙ„Ø§Øª ${dropId} ØºÙŠØ± Ù…Ù…Ù„ÙˆØ¡`);
    }
  });

  console.log(`Ø¹Ø¯Ø¯ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø§Ù„Ù…Ù…Ù„ÙˆØ¡Ø©: ${filledCount} Ù…Ù† ${dropModelIds.length}`);
  console.log(`Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${usedDragIds.join(', ') || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³ØªØ®Ø¯Ù…Ø©'}`);

  var allFilled = (filledCount === dropModelIds.length);
  player.SetVar("allDropsExactlyFilled", allFilled);
  console.log(`allDropsExactlyFilled: ${allFilled}`);
}

// Ø±Ø¨Ø· Ø§Ù„Ø­Ø¯Ø« Ø¨ÙƒÙ„ Ø¹Ù†ØµØ± Ø³Ø­Ø¨
dragModelIds.forEach(function(dId) {
  var el = document.querySelector("[data-model-id='" + dId + "']");
  if (!el) {
    console.warn(`Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${dId}`);
    return;
  }

  el.addEventListener("mouseup", function () {
    console.log(`Ø­Ø¯Ø« mouseup Ù„Ù„Ø¹Ù†ØµØ±: ${dId}`);
    setTimeout(checkDropsFilledAccurately, 100);
  });
});

// ÙØ­Øµ Ø£ÙˆÙ„ÙŠ Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ø¨Ø³ÙŠØ·
setTimeout(checkDropsFilledAccurately, 200);




}

window.Script727 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script728 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script729 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script730 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script731 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script732 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script733 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script734 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script735 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script736 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script737 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script738 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script739 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script740 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script741 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script742 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script743 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script744 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script745 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script746 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script747 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script748 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script749 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script750 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script751 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script752 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script753 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script754 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script755 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script756 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script757 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script758 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script759 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script760 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script761 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script762 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script763 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script764 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script765 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script766 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script767 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script768 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script769 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script770 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script771 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script772 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script773 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script774 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script775 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script776 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script777 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script778 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script779 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script780 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script781 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script782 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script783 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script784 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script785 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script786 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script787 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script788 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script789 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script790 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script791 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script792 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script793 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script794 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script795 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script796 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script797 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script798 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script799 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script800 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script801 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script802 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script803 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script804 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script805 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script806 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script807 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script808 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script809 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script810 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script811 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script812 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script813 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script814 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script815 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script816 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script817 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script818 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script819 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script820 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script821 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script822 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script823 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script824 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script825 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script826 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script827 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script828 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script829 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script830 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script831 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script832 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script833 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script834 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script835 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script836 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script837 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script838 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script839 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script840 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script841 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script842 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script843 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script844 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script845 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script846 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script847 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script848 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script849 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script850 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script851 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script852 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script853 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script854 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script855 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script856 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script857 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script858 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script859 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script860 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script861 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script862 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script863 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script864 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script865 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script866 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script867 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script868 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script869 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script870 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script871 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script872 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script873 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script874 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script875 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script876 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script877 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script878 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script879 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script880 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script881 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script882 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script883 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script884 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script885 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script886 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script887 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script888 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script889 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script890 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script891 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script892 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script893 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script894 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script895 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script896 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script897 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script898 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script899 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script900 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script901 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script902 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script903 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script904 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script905 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script906 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script907 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script908 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script909 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script910 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script911 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script912 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script913 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script914 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script915 = function()
{
  var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex"); // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
var isCorrect = player.GetVar("IsCorrectAnswer"); // true/false
var score = Number(player.GetVar("UserScore")) || 0;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {}; // { qIndex: { prevState: true/false } }
}

// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©)
var prevState = window.scoredQuestions[qIndex]?.prevState;

// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
if (prevState !== isCorrect) {
    if (isCorrect === true || isCorrect === "True") {
        // ÙƒØ§Ù†Øª ØºÙ„Ø· ÙˆØ¨Ù‚Øª ØµØ­ â†’ Ø²ÙˆØ¯ 1
        score += 1;
    } else if ((prevState === true || prevState === "True") && score > 0) {
        // ÙƒØ§Ù†Øª ØµØ­ ÙˆØ¨Ù‚Øª ØºÙ„Ø· â†’ Ù‚Ù„Ù„ 1 ÙÙ‚Ø· Ù„Ùˆ Ø§Ù„Ø³ÙƒÙˆØ± Ø£ÙƒØ¨Ø± Ù…Ù† 0
        score -= 1;
    }
}

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
window.scoredQuestions[qIndex] = { prevState: isCorrect };

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ø§Ø®Ù„ Storyline
player.SetVar("UserScore", score);

// --- Debug Console ---
console.clear();
console.log("ğŸ”¢ Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ•“ Previous State:", prevState);
console.log("ğŸ† UserScore (updated):", score);
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

}

window.Script916 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script917 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script918 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script919 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script920 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script921 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script922 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script923 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script924 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script925 = function()
{
  (function () {
  if (window.top.extMenuInitialized) {
    console.log("extMenu already initialized, skipping...");
    return;
  }
  window.top.extMenuInitialized = true;

  var topWin = window.top,
    topDoc = topWin.document;

  function initializeElements() {
    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let backdrop = topDoc.getElementById("extMenuBackdrop");
    if (!backdrop || !topDoc.body.contains(backdrop)) {
      backdrop = topDoc.createElement("div");
      backdrop.id = "extMenuBackdrop";
      topDoc.body.appendChild(backdrop);
    }

    let panel = topDoc.getElementById("extMenuPanel");
    if (!panel || !topDoc.body.contains(panel)) {
      panel = topDoc.createElement("div");
      panel.id = "extMenuPanel";
      topDoc.body.appendChild(panel);
    }
    return { backdrop, panel };
  }

  var style = topDoc.getElementById("extMenuPanelStyles");
  if (!style) {
    style = topDoc.createElement("style");
    style.id = "extMenuPanelStyles";
    style.textContent = `
      #extMenuBackdrop{
        position: fixed; inset: 0; background: rgba(0,0,0,.28);
        opacity: 0; pointer-events: none; transition: opacity .22s ease;
        z-index: 2147483646;
      }
      #extMenuPanel{
        position: fixed; top: 0; right: 0; width: 360px; height: 100vh;
        z-index: 2147483647; display: flex; flex-direction: column; direction: rtl;
        transform: translateX(100%); transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle {
        width: 900px; height: 65vh;
        left: 50%; top: 47%; right: auto;
        transform: translate(-50%, 100vh); overflow: hidden;
        transition: transform .26s ease;
      }
      #extMenuPanel.terminologyStyle.active {
        transform: translate(-50%, -50%);
      }
      #extMenuIframe{ border: 0; width: 100%; height: 100%; }
      @media (max-width: 480px){ 
        #extMenuPanel{ width: 88vw; }
        #extMenuPanel.terminologyStyle{ 
          width: 90vw; height: 85vh;
        }
      }
    `;
    topDoc.head.appendChild(style);
  }

  var { backdrop, panel } = initializeElements();
  var iframe;
  var isOpen = false;

  function createIframe(src) {
    while (panel.firstChild) {
      panel.firstChild.remove();
    }
    iframe = topDoc.createElement("iframe");
    iframe.id = "extMenuIframe";
    iframe.src = src || "links.html";
    if (src === "Terminology.html") {
      iframe.setAttribute("scrolling", "no");
    }
    panel.appendChild(iframe);

    panel.classList.remove("terminologyStyle", "active");
    if (src === "Terminology.html") {
      panel.classList.add("terminologyStyle");
    }
  }

  function openPanel() {
    if (isOpen) {
      closePanel();
    }
    isOpen = true;

    let existingBackdrops = topDoc.querySelectorAll("#extMenuBackdrop");
    existingBackdrops.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    let existingPanels = topDoc.querySelectorAll("#extMenuPanel");
    existingPanels.forEach((el, index) => {
      if (index > 0) el.remove();
    });

    var elements = initializeElements();
    backdrop = elements.backdrop;
    panel = elements.panel;

    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.add("active");
      panel.style.transform = "translate(-50%, -50%)";
    } else {
      panel.style.transform = "translateX(0)";
    }
    backdrop.style.pointerEvents = "auto";
    backdrop.style.opacity = "1";

    addEventListeners();
  }

  function closePanel() {
    isOpen = false;
    if (panel.classList.contains("terminologyStyle")) {
      panel.classList.remove("active");
      panel.style.transform = "translate(-50%, 100vh)";
    } else {
      panel.style.transform = "translateX(100%)";
    }
    backdrop.style.opacity = "0";
    backdrop.style.pointerEvents = "none";
  }

  function addEventListeners() {
    backdrop.removeEventListener("click", closePanel);
    backdrop.addEventListener("click", closePanel);

    topWin.removeEventListener("keydown", escapeKeyHandler);
    topWin.addEventListener("keydown", escapeKeyHandler, true);
  }

  function escapeKeyHandler(e) {
    if (e.key === "Escape") closePanel();
  }

  topWin.extMenu = {
    open: function (src) {
      var elements = initializeElements();
      backdrop = elements.backdrop;
      panel = elements.panel;
      if (src) createIframe(src);
      openPanel();
    },
    close: closePanel,
    isOpen: function () {
      return isOpen;
    },
  };

  topWin.addEventListener(
    "message",
    function (e) {
      var msg = e && e.data;
      if (!msg) return;

      if (msg === "extMenu:open" || (typeof msg === "object" && msg.type === "extMenu:open")) {
        try {
          var desiredSrc = typeof msg === "object" && msg.src ? msg.src : "links.html";
          var elements = initializeElements();
          backdrop = elements.backdrop;
          panel = elements.panel;
          createIframe(desiredSrc);
          openPanel();
        } catch (_) {}
        return;
      }

      if (msg === "extMenu:close") {
        closePanel();
        return;
      }
      if (msg === "extMenu:toggle") {
        isOpen ? closePanel() : openPanel();
        return;
      }

      if (typeof msg === "object" && msg.type === "extMenu:navigate") {
        try {
          GetPlayer().SetVar("MenuTarget", msg.key || "");
        } catch (_) {}
        return;
      }
    },
    false
  );

  console.log("extMenu initialized and ready");
})();
}

window.Script926 = function()
{
  var player = GetPlayer();
var totalScreens = Number(player.GetVar("TotalScreens") || 11);

// ØªØ­Ù…ÙŠÙ„ Popper.js (Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù€ Tippy.js)
var popper = document.createElement('script');
popper.src = 'https://unpkg.com/@popperjs/core@2';
document.head.appendChild(popper);

// ØªØ­Ù…ÙŠÙ„ Tippy.js
var tippyLib = document.createElement('script');
tippyLib.src = 'https://unpkg.com/tippy.js@6';
document.head.appendChild(tippyLib);

// CSS Ù„Ù€ Tippy
var tippyCss = document.createElement('link');
tippyCss.rel = 'stylesheet';
tippyCss.href = 'https://unpkg.com/tippy.js@6/dist/tippy.css';
document.head.appendChild(tippyCss);

// CSS Ù…Ø®ØµØµ Ù„Ù€ Tippy (Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªÙØ§Ù)
(function () {
  var animId = 'tippy-scale-fade-style';
  if (!document.getElementById(animId)) {
    var s = document.createElement('style');
    s.id = animId;
    s.textContent = `
      .tippy-box[data-animation='scale-fade'] {
        transition-property: transform, opacity;
        padding: 10px;
        border-radius: 6px;
        font-family: 'Graphik Arabic', sans-serif;
        font-size: 14px;
        direction: rtl;
        text-align: right;
        white-space: nowrap !important;
        max-width: none !important;
        width: auto;
        background-color: rgba(0, 0, 0, 0.85);
        color: white;
      }
      .tippy-content {
        white-space: nowrap !important;
        max-width: none !important;
        word-break: keep-all !important;
        overflow: visible !important;
        display: inline-block !important;
      }
      .tippy-box[data-animation='scale-fade'][data-state='hidden'] {
        opacity: 0;
        transform: scale(0.6);
      }
      .tippy-box[data-animation='scale-fade'][data-state='visible'] {
        opacity: 1;
        transform: scale(1);
      }
    `;
    document.head.appendChild(s);
  }
})();

// CSS Ø¬Ø¯ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø© "Ø§Ø¯Ø®Ø§Ù„" (Ù…Ø¹ Ø¥ÙŠØ·Ø§Ù„ÙŠÙƒ ÙˆØ´ÙØ§ÙÙŠØ© 50%)
var placeholderStyle = document.createElement('style');
placeholderStyle.textContent = `
  .custom-placeholder-input {
    color: white !important;
    opacity: 0.5 !important;
    font-style: italic !important;
    pointer-events: none;
    direction: rtl;
    text-align: right;
    font-family: 'Graphik Arabic', sans-serif;
  }
  input:focus .custom-placeholder-input {
    display: none !important;
  }
`;
document.head.appendChild(placeholderStyle);

// Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Tippy.js: Ø±Ø¨Ø· Ø§Ù„Ù€ tooltips
tippyLib.onload = function () {
  function makeTooltip(el, text, placement, extraOptions = {}) {
    try {
      tippy(el, {
        content: text,
        placement: placement || 'left',
        arrow: true,
        theme: 'light-border',
        animation: 'scale-fade',
        duration: [200, 150],
        inertia: true,
        trigger: 'hover mouseenter',
        maxWidth: 'none',
        ...extraOptions
      });
      console.log("âœ… Tooltip Ù…Ø±Ø¨ÙˆØ· Ø¹Ù„Ù‰:", el);
    } catch (e) {
      console.warn('Tooltip bind failed:', el, e);
    }
  }

  function findElementByImageName(imageName) {
    var targetImage = null;
    document.querySelectorAll('svg image').forEach(function (img) {
      var href = img.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||
                 img.getAttribute('xlink:href') || img.getAttribute('href');
      if (href && href.indexOf(imageName) !== -1) {
        targetImage = img;
      }
    });
    if (!targetImage) return null;
    return (targetImage.closest('.slideobject-maskable') ||
            targetImage.closest('.slide-object') ||
            targetImage.closest('svg') || targetImage);
  }

  function bindTooltipWithRetry(imageName, text, placement, flagName, maxRetries = 2) {
    let retries = 0;
    function tryBind() {
      var el = findElementByImageName(imageName);
      if (el && !el[flagName]) {
        makeTooltip(el, text, placement);
        el[flagName] = true;
      } else if (!el && retries < maxRetries) {
        retries++;
        setTimeout(tryBind, 500);
      }
    }
    tryBind();
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  bindTooltipWithRetry('6SX1Z4mXQC1_Q2263C82.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext1');
  bindTooltipWithRetry('6SX1Z4mXQC1_RB2BDE5.png', 'Ø§Ù„ØªØ§Ù„ÙŠ', 'left', '__tippyBoundNext2');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_Q2263C82.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious1');
  bindTooltipWithRetry('6SX1Z4mXQC1_X_RB2BDE5.png', 'Ø§Ù„Ø³Ø§Ø¨Ù‚', 'right', '__tippyBoundPrevious2');
  bindTooltipWithRetry('5ynpEc4yDXQ.png', 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left', '__tippyBoundClose');

  var closeIcon = document.querySelector('#uniqueDomId-214');
  if (closeIcon && !closeIcon.__tippyBoundCloseIcon) {
    makeTooltip(closeIcon, 'Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚', 'left');
    closeIcon.__tippyBoundCloseIcon = true;
  }

  bindTooltipWithRetry('6rIkGKZPcCh.png', 'ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'right', '__tippyBoundFullScreen');
  bindTooltipWithRetry('5YWES39YH85.png', 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'left', '__tippyBoundHome');

  // Tooltip Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ù Ø§Ù„Ø³Ø·Ø±)
  function bindInputTooltip() {
    var inputField = document.querySelector('input[data-dv_ref="input"], .slide-object-textinput input[type="text"], input[type="number"]');
    var currentSlide = Number(player.GetVar("Screen") || 0);

    if (inputField && !inputField.__tippyBoundInput) {
      var tooltipText = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§';
      var htmlContent = `
        <div style="
          white-space: nowrap !important;
          word-break: normal !important;
          font-family: 'Graphik Arabic', sans-serif;
          direction: rtl;
          text-align: right;
          font-size: 14px;
          line-height: 1.3;
          overflow: visible !important;
          display: inline-block !important;
          max-width: none !important;
          width: auto !important;
          color: white;
        ">
          ${tooltipText}
        </div>
      `;

      makeTooltip(inputField, htmlContent, 'top', { allowHTML: true });
      inputField.__tippyBoundInput = true;
      console.log("âœ… Input tooltip Ù…Ø±Ø¨ÙˆØ· ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©:", currentSlide);
    } else if (!inputField) {
      var retryDelay = (currentSlide === 8) ? 1000 : 500;
      var maxRetries = (currentSlide === 8) ? 3 : 2;
      let retries = 0;
      function retryBind() {
        if (retries < maxRetries) {
          retries++;
          setTimeout(bindInputTooltip, retryDelay);
          console.log("ğŸ” Retry tooltip ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide + " (Ù…Ø­Ø§ÙˆÙ„Ø© " + retries + ")");
        } else {
          console.warn("âš ï¸ Tooltip Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© " + currentSlide);
        }
      }
      retryBind();
    }
  }
  bindInputTooltip();

  // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
  var lastScreen = Number(player.GetVar("Screen") || 0);
  setInterval(function () {
    var currentScreen = Number(player.GetVar("Screen") || 0);
    if (currentScreen !== lastScreen) {
      lastScreen = currentScreen;
      setTimeout(bindInputTooltip, 500);
    }
  }, 500);
};

// Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Enter + "Ø§Ø¯Ø®Ø§Ù„" placeholder
setTimeout(function () {
  var inputs = document.querySelectorAll('input[type="number"], input[type="text"]');
  if (inputs.length === 0) return;

  for (let i = 0; i < inputs.length; i++) {
    var input = inputs[i];

    input.addEventListener('mouseenter', function () { this.focus(); });
    input.addEventListener('click', function () { this.focus(); });

    var placeholderText = "Ø§Ø¯Ø®Ø§Ù„";
    input.placeholder = placeholderText;
    input.classList.add('custom-placeholder-input');

    input.addEventListener('focus', function () {
      if (this.value === placeholderText) {
        this.value = "";
      }
      this.style.color = "black";
      console.log("âœï¸ Focus: placeholder Ø§Ø®ØªÙÙ‰ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙƒØªØ§Ø¨Ø©");
    });

    input.addEventListener('blur', function () {
      if (this.value === "" || this.value.trim() === "") {
        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
      }
      console.log("ğŸ‘ï¸ Blur: placeholder Ø±Ø¬Ø¹");
    });

    input.addEventListener("keydown", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        event.stopImmediatePropagation();
        var rawValue = this.value.trim();
        if (rawValue === placeholderText) rawValue = "";
        var slideNum = parseInt(rawValue, 10);

        this.value = placeholderText;
        this.style.color = "rgba(255, 255, 255, 0.5)";
        this.style.fontStyle = "italic";
        var x = document.getElementsByTagName("input");
        for (let index = 0; index < x.length; index++) {
          if (x[index] !== this) x[index].value = "";
        }

        if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalScreens && rawValue !== placeholderText) {
          player.SetVar("NumericEntry1", slideNum);
          player.SetVar("Screen", slideNum);
          this.blur();
          console.log("âœ… Ù‚ÙØ² Ø¥Ù„Ù‰:", slideNum);
        } else {
          console.warn("âŒ Ø±Ù‚Ù… ØºÙ„Ø·:", slideNum);
          player.SetVar("ShowError", true);
          this.blur();
        }

        setTimeout(function () {
          var newScreen = Number(player.GetVar("Screen"));
          var ifr = document.querySelector('iframe');
          if (ifr && ifr.contentWindow) {
            ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: newScreen }, '*');
          }
        }, 200);
      }
    }, { passive: false });
  }
  console.log("âœ¨ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¬Ø§Ù‡Ø²Ø© â€“ Placeholder 'Ø§Ø¯Ø®Ø§Ù„' (italic Ø£Ø¨ÙŠØ¶ 50%) Ø´ØºØ§Ù„.");
}, 0);

}

window.Script927 = function()
{
  DS.appState.onToggleVolume(0);
}

window.Script928 = function()
{
  DS.appState.onToggleVolume(1);
}

window.Script929 = function()
{
  /*var player = GetPlayer();
var sc = Number(player.GetVar('screen') || 0);
var ifr = document.querySelector('iframe');
if(ifr && ifr.contentWindow){
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}*/


var player = GetPlayer();
var sc = Number(player.GetVar('Screen') || 0);  // ØºÙŠØ±Øª 'screen' Ø¥Ù„Ù‰ 'Screen'
var ifr = document.querySelector('iframe');
if (ifr && ifr.contentWindow) {
  ifr.contentWindow.postMessage({ type: 'extMenu:updateActive', screen: sc }, '*');
}
console.log("ğŸ“¡ postMessage Ù…Ø±Ø³Ù„ Ù„Ù€ screen:", sc);  // Ø£Ø¶ÙØª Ø¯Ù‡ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Console
}

window.Script930 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script931 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

window.Script932 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}

}

window.Script933 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}



}

window.Script934 = function()
{
  // ===== JS for final question =====
var player = GetPlayer();

var qIndex = player.GetVar("CurrentQuestionIndex");
var isCorrect = player.GetVar("IsCorrectAnswer");
var score = player.GetVar("UserScore");

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¬Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
if (typeof window.scoredQuestions === 'undefined') {
    window.scoredQuestions = {};
}

// Ù„Ùˆ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù„Ø³Ù‡ Ù…Ø§ Ø§ØªØ­Ø³Ø¨Ø´ Ù‚Ø¨Ù„ ÙƒØ¯Ù‡
if (!window.scoredQuestions[qIndex]) {
    if (isCorrect === true || isCorrect === "True") {
        score = Number(score) + 1;
        player.SetVar("UserScore", score);
    }
    window.scoredQuestions[qIndex] = { prevState: isCorrect };
} else {
    // Ù„Ùˆ Ø§ØªØ­Ø³Ø¨ Ù‚Ø¨Ù„ ÙƒØ¯Ù‡ØŒ Ø´ÙˆÙ Ø¥Ø°Ø§ ØªØºÙŠØ±Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
    var prevState = window.scoredQuestions[qIndex].prevState;
    if (prevState !== isCorrect) {
        if (isCorrect === true || isCorrect === "True") {
            score = Number(score) + 1;
        } else if (score > 0) {
            score = Number(score) - 1;
        }
        player.SetVar("UserScore", score);
        window.scoredQuestions[qIndex].prevState = isCorrect;
    }
}

// âœ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
var totalQuestions = 10; // Ø¹Ø¯Ù‘Ù„Ù‡Ø§ Ø­Ø³Ø¨ Ø¹Ø¯Ø¯ Ø£Ø³Ø¦Ù„ØªÙƒ
var percent = Math.round((score / totalQuestions) * 100);
player.SetVar("ScorePercent", percent);

// ===== DEBUG Console Output =====
console.clear();
console.log("ğŸ”¢ Final Question Index:", qIndex);
console.log("âœ… IsCorrectAnswer:", isCorrect);
console.log("ğŸ† UserScore (final):", score);
console.log("ğŸ“Š ScorePercent:", percent + "%");
console.log("ğŸ“‹ All Question States:", window.scoredQuestions);

// ===== Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙÙŠØ¯Ø¨Ø§Ùƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ =====
if (percent >= 60) {
    player.SetVar("FinalFeedback", "Ø±Ø§Ø¦Ø¹! Ù„Ù‚Ø¯ Ø§Ø¬ØªØ²Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­ ğŸ‘");
} else {
    player.SetVar("FinalFeedback", "Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ğŸ˜… Ø§Ù„Ù†Ø³Ø¨Ø© Ø£Ù‚Ù„ Ù…Ù† 60%");
}

}

window.Script935 = function()
{
  function add_script(scriptURL,oID) {
     var scriptEl = document.createElement("script");
     var head=document.getElementsByTagName('head')[0];
      scriptEl.type = "text/javascript";      
      scriptEl.src = scriptURL;      
      scriptEl.id=oID;      
      head.appendChild(scriptEl);}

//only want to add these once!
if(document.getElementById('jquery')==null){
add_script("https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js","jquery");

}


/* Get into full screen */
function GoInFullscreen(preso) {
	if(preso.requestFullscreen)
		preso.requestFullscreen();
	else if(preso.mozRequestFullScreen)
		preso.mozRequestFullScreen();
	else if(preso.webkitRequestFullscreen)
		preso.webkitRequestFullscreen();
	else if(preso.msRequestFullscreen)
		preso.msRequestFullscreen();
}

/* Get out of full screen */
function GoOutFullscreen() {
	if(document.exitFullscreen)
		document.exitFullscreen();
	else if(document.mozCancelFullScreen)
		document.mozCancelFullScreen();
	else if(document.webkitExitFullscreen)
		document.webkitExitFullscreen();
	else if(document.msExitFullscreen)
		document.msExitFullscreen();
}

/* Is currently in full screen or not */
function IsFullScreenCurrently() {
	var full_screen_preso = document.fullscreenpreso || document.webkitFullscreenpreso || document.mozFullScreenpreso || document.msFullscreenpreso || null;
	
	// If no preso is in full-screen
	if(full_screen_preso === null)
		return false;
	else
		return true;
}

GoOutFullscreen();

}

window.Script936 = function()
{
  var fullStorylinePlayer = document.querySelectorAll("html");
if (fullStorylinePlayer[0].requestFullscreen) {
fullStorylinePlayer[0].requestFullscreen();
}else if (fullStorylinePlayer[0].mozRequestFullScreen) {
fullStorylinePlayer[0].mozRequestFullScreen(); // Firefox
}else if (fullStorylinePlayer[0].webkitRequestFullscreen) {
fullStorylinePlayer[0].webkitRequestFullscreen(); // Chrome and Safari
}else if (fullStorylinePlayer[0].msRequestFullscreen) {
fullStorylinePlayer[0].msRequestFullscreen(); // IE
}
}

window.Script937 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script938 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'links.html' }, '*');

}

window.Script939 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script940 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'Terminology.html' }, '*');
}

window.Script941 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script942 = function()
{
  window.top.postMessage({ type: 'extMenu:open', src: 'search.html' }, '*');

}

window.Script943 = function()
{
  //document.querySelector("#slide-window > div > div > div.slide-transition-container > div > div > div.slide-layer.base-layer.shown > div.slide-object.slide-object-textinput.shown > div > div > input[type=text]").value =""

var x = document.getElementsByTagName("input");
for (let index = 0; index < x.length; index++) {
    x[index].value="";
}


}

};
